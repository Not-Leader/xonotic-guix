<p><br>
<center>
	<img src="https://xonotic.org/static/img/xonotic-logo.png"><br>
<div style="padding: 20px; background-color: #EEFFEE; font-size: 14pt; display: inline-block; font-weight: bold">
Hi. This is just some 3 Euro VPS from OVH which I use as Xonotic server. It seems to handle at least 16 players. <p>
Check out <a href="https://xonotic.org">Xonotic</a> and <a href="https://ballerburg.us.to">my website</a>.<p>
</div><p>
OVH offers the following locations:
<pre>
North America, Canada, Beauharnois (BHS)
Pacific Asia, Australia, Sydney (SYD)
Western Europe, France, Gravelines (GRA)
Western Europe, France, Strasbourg (SBG)
Central Europe, Poland, Warsaw (WAW)
Central Europe, Germany, Frankfurt (DE)
Western Europe, United Kingdom, London (UK)
</pre>
The dynamic DNS provider I use to get a "us.to" subdomain is <a href="http://afraid.org">Afraid.org</a> (this is not required).
</center>
<div style="padding: 40px;">
<h3>If you want to recreate this server (Ubuntu):</h3>
<br>
Edit the file <b>/etc/systemd/system/xonotic.service</b> :<p>
<pre style="background-color: #EEE; padding: 20px">
[Unit]
Description=Xonotic
After=network.target

StartLimitIntervalSec=500
StartLimitBurst=5

[Service]
WorkingDirectory=/home/xonotic/Xonotic
ExecStart=/usr/bin/screen -dmS xonotic-server /bin/sh -c 'echo -en "\n\n\n$(date)\n\n\n" &gt;&gt; /home/xonotic/xonotic.log; /home/xonotic/Xonotic/xonotic-linux-dedicated.sh 2&gt;&amp;1 | tee -a /home/xonotic/xonotic.log'
User=xonotic
Type=forking

Restart=always
RestartSec=5s

[Install]
WantedBy=graphical.target #check target by running: systemctl get-default

</pre>
<br>
Prepare the system: install packages, setup xonotic user, lighttpd for fast pk3 download and zsh :<p>
<pre style="background-color: #EEE; padding: 20px">
apt install unzip zsh curl wget screen lighttpd vim php php-cgi php-mysql

# Oh my Zsh
sh -c "$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"

lighty-enable-mod fastcgi fastcgi-php dir-listing rewrite

systemctl daemon-reload
systemctl enable xonotic lighttd 
systemctl start lighttpd

useradd -u 9005 -m xonotic -G root,audio -g www-data -s `which zsh`

# move the www dir to xonotic user, makes scp backups easier
rm -r /var/www/html
ln -s /home/xonotic/www /var/www/html
ln /etc/systemd/system/xonotic.service /home/xonotic

# --- &gt; now put your id_rsa.pub into /root/.ssh/authorized_keys
# also add your root account's id_rsa.pub, if you want to run cronjob backups that preserve ownership

su xonotic

unset ZSH
sh -c "$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"

mkdir -p /home/xonotic/www
cd /home/xonotic/www

# needed for fast downloads, set the correct URL in your server.cfg as well! (e.g. http://1.2.3.4/xonotic/ )
ln -s /home/xonotic/.xonotic/data /var/www/html/xonotic

# needed for website
ln -s /home/xonotic/README.md /var/www/html/README.md

</pre>
<br>

Download the latest Xonotic autobuild ZIP and unzip:<p>

<pre style="background-color: #EEE; padding: 20px">
cd /home/xonotic
wget https://beta.xonotic.org/autobuild/Xonotic-`date +%Y%m%d  --date="3 days ago"`.zip
unzip Xonotic-`date +%Y%m%d  --date="3 days ago"`.zip
rm Xonotic-`date +%Y%m%d  --date="3 days ago"`.zip
</pre>
<br>

Download the maps and server config from this server "xonotic.us.to":<p>

<pre style="background-color: #EEE; padding: 20px">
mkdir -p /home/xonotic/.xonotic/data/data
chmod 700 /home/xonotic/.xonotic/data/data

# this is the data directory on my server
wget -r http://xonotic.us.to/xonotic/
mv xonotic.us.to/xonotic/* /home/xonotic/.xonotic/data/
rm -r xonotic.us.to
</pre>
<br>

<b>Edit /home/xonotic/.xonotic/data/server.cfg!</b>:<p>

<pre style="background-color: #eee; padding: 20px">
export MYSERVER="example.com" # (or ip address like 15.26.37.48)
sed "s/xonotic\.us\.to/$MYSERVER/g" -i /home/xonotic/.xonotic/data/server.cfg
sed "s/xonotic\.us\.to/$MYSERVER/g" -i /var/www/html/index.html

# you can control the server if connected inside Xonotic as a player with this password
echo '//rcon_password "SuperSecretPassword6666666"' &gt;  /home/xonotic/.xonotic/data/secret.cfg # remove //
chmod 700 /home/xonotic/.xonotic/data/secret.cfg
</pre>

And finally run the Xonotic dedicated server:<p>

<pre style="background-color: #EEE; padding: 20px">
exit # to root shell
systemctl start xonotic
</pre>
<br>
<br>


USEFUL: If you download new maps, then this command gives you a nice updated list from the ZIP files (paste it in server.cfg)<p>

<pre style="background-color: #eee; padding: 20px">
MAPUPDATE=;IFS=$'\n'; echo -n "\n\ng_maplist \""; for i in /home/xonotic/.xonotic/data/*.pk3; do if unzip -l "$i" | grep -q '\.bsp$'; then echo -n "$(unzip -l "$i" | grep '[^/]*\.bsp$' -osa | sed "s/\.bsp$//g" | tr '\n' ' ')"; fi; done; echo "\"\n\n"
</pre>
<br>

USEFUL: Backup command for cronjob (on remote machine)<p>

<pre style="background-color: #EEE; padding: 20px">
rsync --exclude 'Xonotic' -ra root@xonotic.us.to:/home/xonotic/ /mnt/1/BACKUP/XONOTIC_SERVER/
</pre>
<br>

USEFUL: SSH directly into interactive Xonotic server console (from remote machine)<p>

<pre style="background-color: #EEE; padding: 20px">
XONOTICSERVER=; ssh -t root@xonotic.us.to "su xonotic -c 'screen -r xonotic-server'"
</pre>
<br>

To create a backup on Github, I created a new account there, added an access token to it and then on my main account granted that user access to an empty repo. Then logged in as xonotic on my server I simply cloned that repo, copied the .git directory to /home/xonotic, edited .git/config to include the user:accesstoken@ before the URL and added the following to a crontab of the xonotic user: 

<pre style="background-color: #EEE; padding: 20px">
cd $HOME; export GIT_HTTP_MAX_REQUEST_BUFFER=1000M; git config --global http.postBuffer 1048576000; git pull; git submodule update --remote --recursive; git add -u; git add  * .*; git commit -m "."; git push
</pre>
You should test this command first.

</div>
</div>
